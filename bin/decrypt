#! /usr/bin/env ruby

require './entry_decrypter'

key_paths = Dir['private_keys/*.key']
rsa_keys = key_paths.map { |path| OpenSSL::PKey::RSA.new(File.read(path)) }

filename = ARGV.first
encryption_json = File.read filename
encryption_details = JSON.parse encryption_json

decrypter = EntryDecrypter.new encryption_details, rsa_keys
decrypter.decrypt
puts decrypter.filename
puts decrypter.text
